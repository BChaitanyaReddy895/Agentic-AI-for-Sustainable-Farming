<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#16a34a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="AgriSmart AI â€” Smart Sustainable Farming Assistant">
    <title>AgriSmart AI â€” Smart Farming</title>

    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icons/icon-192.png" type="image/png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <!-- Plotly -->
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>

    <!-- App CSS -->
    <link rel="stylesheet" href="styles_modern.css">
    <link rel="stylesheet" href="voice-styles.css">
    <link rel="stylesheet" href="mobile-styles.css">
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• AUTH SCREEN â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="auth-screen" id="auth-screen">
    <div class="auth-bg">
        <div class="auth-gradient"></div>
    </div>
    <div class="auth-container">
        <!-- Logo -->
        <div class="auth-logo-wrap">
            <div class="auth-logo-icon"><i class="fas fa-leaf"></i></div>
            <h1 class="auth-app-name" data-i18n="auth.appName">AgriSmart AI</h1>
            <p class="auth-tagline" data-i18n="auth.tagline">Smart Sustainable Farming</p>
        </div>
        <!-- Auth Card -->
        <div class="auth-card glass">
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="signup" onclick="switchAuthTab('signup')" data-i18n="auth.createAccount">Create Account</button>
                <button class="auth-tab" data-tab="login" onclick="switchAuthTab('login')" data-i18n="auth.login">Login</button>
            </div>
            <!-- Signup -->
            <form id="signup-form" class="auth-form active" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> <span data-i18n="auth.yourName">Your Name *</span></label>
                    <input type="text" id="signup-name" placeholder="Enter your name" data-i18n-placeholder="auth.namePlaceholder" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-home"></i> <span data-i18n="auth.farmName">Farm Name *</span></label>
                    <input type="text" id="signup-farm" placeholder="e.g. Green Valley Farm" data-i18n-placeholder="auth.farmPlaceholder" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-phone"></i> <span data-i18n="auth.phone">Phone</span></label>
                    <input type="tel" id="signup-phone" placeholder="Phone number" data-i18n-placeholder="auth.phonePlaceholder">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-map-marker-alt"></i> <span data-i18n="auth.location">Location</span></label>
                    <input type="text" id="signup-location" placeholder="Village / City" data-i18n-placeholder="auth.locationPlaceholder">
                </div>
                <button type="submit" class="btn btn-primary btn-full"><i class="fas fa-arrow-right"></i> <span data-i18n="auth.getStarted">Get Started</span></button>
            </form>
            <!-- Login -->
            <form id="login-form" class="auth-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label><i class="fas fa-phone"></i> <span data-i18n="auth.phoneNumber">Phone Number</span></label>
                    <input type="tel" id="login-phone" placeholder="Enter phone" data-i18n-placeholder="auth.loginPhonePlaceholder" required>
                </div>
                <div class="form-group">
                    <label><i class="fas fa-lock"></i> <span data-i18n="auth.password">Password</span></label>
                    <input type="password" id="login-password" placeholder="Password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-full"><i class="fas fa-sign-in-alt"></i> <span data-i18n="auth.loginBtn">Login</span></button>
            </form>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APP SHELL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app-shell" id="app-shell" style="display:none">

    <!-- â”€â”€â”€â”€ SIDEBAR (Desktop) â”€â”€â”€â”€ -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <div class="sidebar-logo-icon"><i class="fas fa-leaf"></i></div>
                <div><span class="sidebar-brand" data-i18n="auth.appName">AgriSmart AI</span><span class="sidebar-sub" data-i18n="nav.smartFarming">Smart Farming</span></div>
            </div>
        </div>
        <div class="sidebar-profile" id="sidebar-profile">
            <div class="sidebar-avatar" id="sidebar-avatar">F</div>
            <div class="sidebar-user">
                <span class="sidebar-username" id="sidebar-username">Farmer</span>
                <span class="sidebar-farmname" id="sidebar-farmname">My Farm</span>
            </div>
        </div>
        <nav class="sidebar-nav">
            <a class="sidebar-link active" data-page="dashboard" onclick="navigate('dashboard')"><i class="fas fa-home"></i><span data-i18n="nav.dashboard">Dashboard</span></a>
            <a class="sidebar-link" data-page="farm-setup" onclick="navigate('farm-setup')"><i class="fas fa-tractor"></i><span data-i18n="nav.farmSetup">Farm Setup</span></a>
            <a class="sidebar-link" data-page="recommendation" onclick="navigate('recommendation')"><i class="fas fa-seedling"></i><span data-i18n="nav.recommendations">AI Recommendations</span></a>
            <a class="sidebar-link" data-page="rotation" onclick="navigate('rotation')"><i class="fas fa-calendar-alt"></i><span data-i18n="nav.cropPlanner">Crop Planner</span></a>
            <a class="sidebar-link" data-page="fertilizer" onclick="navigate('fertilizer')"><i class="fas fa-flask"></i><span data-i18n="nav.fertilizer">Fertilizer Calculator</span></a>
            <a class="sidebar-link" data-page="farm-map" onclick="navigate('farm-map')"><i class="fas fa-map"></i><span data-i18n="nav.farmMap">Farm Map</span></a>
            <a class="sidebar-link" data-page="sustainability" onclick="navigate('sustainability')"><i class="fas fa-chart-bar"></i><span data-i18n="nav.sustainability">Sustainability</span></a>
            <a class="sidebar-link" data-page="community" onclick="navigate('community')"><i class="fas fa-users"></i><span data-i18n="nav.community">Community</span></a>
            <a class="sidebar-link" data-page="market" onclick="navigate('market')"><i class="fas fa-chart-line"></i><span data-i18n="nav.market">Market Forecast</span></a>
            <a class="sidebar-link" data-page="chatbot" onclick="navigate('chatbot')"><i class="fas fa-comment-dots"></i><span data-i18n="nav.chatbot">AI Assistant</span><span class="sidebar-badge">AI</span></a>
            <a class="sidebar-link" data-page="weather" onclick="navigate('weather')"><i class="fas fa-cloud-sun"></i><span data-i18n="nav.weather">Weather</span></a>
            <a class="sidebar-link" data-page="soil-analysis" onclick="navigate('soil-analysis')"><i class="fas fa-microscope"></i><span data-i18n="nav.soilAnalysis">Soil Analysis</span></a>
            <a class="sidebar-link" data-page="pest-prediction" onclick="navigate('pest-prediction')"><i class="fas fa-bug"></i><span data-i18n="nav.pestPrediction">Pest Prediction</span></a>
        </nav>
        <div class="sidebar-footer">
            <a class="sidebar-link" data-page="history" onclick="navigate('history')"><i class="fas fa-history"></i><span data-i18n="nav.history">My History</span></a>
            <a class="sidebar-link" data-page="offline" onclick="navigate('offline')"><i class="fas fa-cloud"></i><span data-i18n="nav.offline">Offline Mode</span></a>
            <a class="sidebar-link" data-page="profile" onclick="navigate('profile')"><i class="fas fa-cog"></i><span data-i18n="nav.settings">Settings</span></a>
            <button class="sidebar-link logout-link" onclick="logout()"><i class="fas fa-sign-out-alt"></i><span data-i18n="nav.logout">Logout</span></button>
        </div>
    </aside>

    <!-- Mobile Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay" onclick="closeMobileMenu()"></div>

    <!-- â”€â”€â”€â”€ MAIN AREA â”€â”€â”€â”€ -->
    <div class="main-area">

        <!-- Offline Banner -->
        <div class="offline-bar" id="offline-bar" style="display:none">
            <i class="fas fa-wifi-slash"></i> <span data-i18n="offline.banner">You're offline. Changes will sync when connection is restored.</span>
            <span class="pending-badge" id="pending-badge" style="display:none"><i class="fas fa-sync-alt fa-spin"></i> <span id="pending-count">0</span> pending</span>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIMPLE MODE TOGGLE (for illiterate farmers) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <button class="simple-mode-toggle" id="simple-mode-toggle" onclick="toggleSimpleMode()" title="Simple Mode for Easy Use">
            <span class="smt-icon">ğŸ‘¨â€ğŸŒ¾</span>
            <span class="smt-label" data-i18n="simple.toggle">Simple Mode</span>
        </button>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• PICTURE NAVIGATION (Simple Mode) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <div class="picture-nav" id="picture-nav" style="display:none">
            <div class="picture-nav-grid">
                <button class="pic-nav-btn" onclick="navigate('farm-setup')" data-page="farm-setup">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#16a34a,#22d3ee)">ğŸšœ</div>
                    <span data-i18n="nav.farmSetup">Farm Setup</span>
                </button>
                <button class="pic-nav-btn" onclick="oneTapAdvice()" id="one-tap-nav-btn">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#8b5cf6,#ec4899)">ğŸ§ </div>
                    <span data-i18n="simple.getAdvice">Get Advice</span>
                </button>
                <button class="pic-nav-btn" onclick="navigate('weather')" data-page="weather">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#0ea5e9,#06b6d4)">ğŸŒ¤ï¸</div>
                    <span data-i18n="nav.weather">Weather</span>
                </button>
                <button class="pic-nav-btn" onclick="navigate('pest-prediction')" data-page="pest-prediction">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#ef4444,#f97316)">ğŸ›</div>
                    <span data-i18n="nav.pestPrediction">Pest Alert</span>
                </button>
                <button class="pic-nav-btn" onclick="navigate('community')" data-page="community">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#6366f1,#8b5cf6)">ğŸ‘¥</div>
                    <span data-i18n="nav.community">Community</span>
                </button>
                <button class="pic-nav-btn" onclick="navigate('soil-analysis')" data-page="soil-analysis">
                    <div class="pic-nav-icon" style="background:linear-gradient(135deg,#92400e,#d97706)">ğŸ”¬</div>
                    <span data-i18n="nav.soilAnalysis">Soil Check</span>
                </button>
            </div>
        </div>

        <!-- Language Selector (top-right floating) -->
        <div class="lang-float" id="lang-float">
            <button class="lang-float-btn" onclick="toggleLangMenu()"><i class="fas fa-globe"></i> <span id="lang-label">EN</span></button>
            <div class="lang-float-menu" id="lang-menu">
                <div class="lang-opt" onclick="changeLanguage('en')">ğŸ‡¬ğŸ‡§ English</div>
                <div class="lang-opt" onclick="changeLanguage('hi')">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€</div>
                <div class="lang-opt" onclick="changeLanguage('kn')">ğŸ‡®ğŸ‡³ à²•à²¨à³à²¨à²¡</div>
                <div class="lang-opt" onclick="changeLanguage('te')">ğŸ‡®ğŸ‡³ à°¤à±†à°²à±à°—à±</div>
                <div class="lang-opt" onclick="changeLanguage('ta')">ğŸ‡®ğŸ‡³ à®¤à®®à®¿à®´à¯</div>
                <div class="lang-opt" onclick="changeLanguage('ml')">ğŸ‡®ğŸ‡³ à´®à´²à´¯à´¾à´³à´‚</div>
                <div class="lang-opt" onclick="changeLanguage('bn')">ğŸ‡®ğŸ‡³ à¦¬à¦¾à¦‚à¦²à¦¾</div>
                <div class="lang-opt" onclick="changeLanguage('gu')">ğŸ‡®ğŸ‡³ àª—à«àªœàª°àª¾àª¤à«€</div>
                <div class="lang-opt" onclick="changeLanguage('mr')">ğŸ‡®ğŸ‡³ à¤®à¤°à¤¾à¤ à¥€</div>
                <div class="lang-opt" onclick="changeLanguage('pa')">ğŸ‡®ğŸ‡³ à¨ªà©°à¨œà¨¾à¨¬à©€</div>
                <div class="lang-opt" onclick="changeLanguage('or')">ğŸ‡®ğŸ‡³ à¬“à¬¡à¬¼à¬¿à¬†</div>
            </div>
        </div>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• PAGES â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

        <!-- ===== DASHBOARD ===== -->
        <section id="dashboard-page" class="page active">
            <div class="page-pad">
                <!-- â•â•â• ONE-TAP SMART ADVICE (Simple Mode) â•â•â• -->
                <div class="one-tap-section simple-only" id="one-tap-section" style="display:none">
                    <div class="one-tap-card">
                        <div class="one-tap-illustration">
                            <svg viewBox="0 0 120 120" width="100" height="100">
                                <circle cx="60" cy="60" r="55" fill="#f0fdf4" stroke="#16a34a" stroke-width="3"/>
                                <text x="60" y="50" text-anchor="middle" font-size="36">ğŸŒ¾</text>
                                <text x="60" y="80" text-anchor="middle" font-size="12" fill="#16a34a" font-weight="bold">AI</text>
                                <circle cx="60" cy="60" r="55" fill="none" stroke="#16a34a" stroke-width="2" opacity="0.3">
                                    <animate attributeName="r" values="50;58;50" dur="2s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" values="0.3;0;0.3" dur="2s" repeatCount="indefinite"/>
                                </circle>
                            </svg>
                        </div>
                        <h2 class="one-tap-title" data-i18n="simple.oneTapTitle">ğŸŒ¾ Get My Farm Advice</h2>
                        <p class="one-tap-desc" data-i18n="simple.oneTapDesc">One tap â€” we find your location, check weather, and tell you what to grow!</p>
                        <button class="btn btn-primary btn-mega one-tap-btn" id="one-tap-btn" onclick="oneTapAdvice()">
                            <i class="fas fa-magic"></i> <span data-i18n="simple.tapHere">Tap Here!</span>
                        </button>
                        <div class="one-tap-progress" id="one-tap-progress" style="display:none">
                            <div class="otp-step" id="otp-step-1"><span class="otp-emoji">ğŸ“</span> <span data-i18n="simple.findingLocation">Finding your location...</span></div>
                            <div class="otp-step" id="otp-step-2"><span class="otp-emoji">ğŸŒ¤ï¸</span> <span data-i18n="simple.checkingWeather">Checking weather...</span></div>
                            <div class="otp-step" id="otp-step-3"><span class="otp-emoji">ğŸ§ </span> <span data-i18n="simple.aiThinking">AI is thinking...</span></div>
                            <div class="otp-step" id="otp-step-4"><span class="otp-emoji">ğŸ”Š</span> <span data-i18n="simple.readingResult">Reading your advice...</span></div>
                        </div>
                        <div class="one-tap-result" id="one-tap-result" style="display:none"></div>
                    </div>
                </div>

                <!-- â•â•â• SIMPLE WEATHER DISPLAY (Simple Mode) â•â•â• -->
                <div class="simple-weather simple-only" id="simple-weather" style="display:none">
                    <div class="simple-weather-icon" id="simple-weather-icon">â˜€ï¸</div>
                    <div class="simple-weather-temp" id="simple-weather-temp">28Â°</div>
                    <div class="simple-weather-status" id="simple-weather-status">
                        <span class="traffic-light green" id="weather-traffic-light"></span>
                        <span data-i18n="simple.goodWeather">Good weather for farming</span>
                    </div>
                </div>

                <!-- Hero -->
                <div class="dash-hero">
                    <div class="dash-hero-bg"></div>
                    <div class="dash-hero-content">
                        <p class="dash-greeting" id="dash-greeting" data-i18n="dash.goodMorning">Good Morning,</p>
                        <h1 class="dash-name" id="dash-name">Farmer ğŸŒ¾</h1>
                        <p class="dash-farm" id="dash-farm"></p>
                        <div class="dash-weather-chips">
                            <div class="weather-chip"><i class="fas fa-sun"></i> <span id="dash-temp">28Â°C</span></div>
                            <div class="weather-chip"><i class="fas fa-tint"></i> <span id="dash-humidity">65%</span></div>
                            <div class="weather-chip"><i class="fas fa-wind"></i> <span id="dash-wind">12 km/h</span></div>
                        </div>
                    </div>
                </div>

                <!-- Quick Stats -->
                <div class="stat-grid">
                    <div class="stat-card stat-green">
                        <i class="fas fa-map stat-icon"></i>
                        <div class="stat-value" id="stat-farm-size">â€”</div>
                        <div class="stat-label" data-i18n="dash.farmSize">Farm Size</div>
                    </div>
                    <div class="stat-card stat-blue">
                        <i class="fas fa-leaf stat-icon"></i>
                        <div class="stat-value" id="stat-sustain">â€”</div>
                        <div class="stat-label" data-i18n="dash.sustainability">Sustainability</div>
                    </div>
                    <div class="stat-card stat-amber">
                        <i class="fas fa-seedling stat-icon"></i>
                        <div class="stat-value" id="stat-recs">0</div>
                        <div class="stat-label" data-i18n="dash.recommendations">Recommendations</div>
                    </div>
                    <div class="stat-card stat-purple">
                        <i class="fas fa-users stat-icon"></i>
                        <div class="stat-value">5K+</div>
                        <div class="stat-label" data-i18n="dash.farmers">Farmers</div>
                    </div>
                </div>

                <!-- Live Weather & Crop Health Row -->
                <div class="dash-live-row">
                    <div class="card dash-weather-live">
                        <h3 class="card-title"><i class="fas fa-cloud-sun"></i> Today's Weather</h3>
                        <div class="dash-weather-big">
                            <div class="weather-big-temp" id="dash-big-temp">28Â°</div>
                            <div class="weather-big-desc" id="dash-big-desc">Partly Cloudy</div>
                        </div>
                        <div class="dash-weather-details">
                            <div><i class="fas fa-tint"></i> Humidity: <strong id="dash-det-hum">65%</strong></div>
                            <div><i class="fas fa-wind"></i> Wind: <strong id="dash-det-wind">12 km/h</strong></div>
                            <div><i class="fas fa-cloud-rain"></i> Rain: <strong id="dash-det-rain">0 mm</strong></div>
                        </div>
                    </div>
                    <div class="card dash-crop-health">
                        <h3 class="card-title"><i class="fas fa-heartbeat"></i> Farm Health</h3>
                        <div class="health-ring-wrap">
                            <div class="health-ring" id="dash-health-ring">
                                <svg viewBox="0 0 120 120"><circle cx="60" cy="60" r="52" fill="none" stroke="#e5e7eb" stroke-width="10"/><circle cx="60" cy="60" r="52" fill="none" stroke="#16a34a" stroke-width="10" stroke-dasharray="327" stroke-dashoffset="65" stroke-linecap="round" transform="rotate(-90 60 60)" id="health-arc"/></svg>
                                <span class="health-ring-val" id="dash-health-score">80%</span>
                            </div>
                            <div class="health-labels">
                                <div><span class="dot green"></span> Soil: Good</div>
                                <div><span class="dot blue"></span> Water: OK</div>
                                <div id="dash-pest-status"><span class="dot green"></span> Pest Risk: Low</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card mt-3">
                    <h3 class="card-title"><i class="fas fa-clock"></i> Recent Activity</h3>
                    <div id="dash-recent-activity" class="activity-feed">
                        <div class="activity-item"><div class="activity-dot green"></div><span>Welcome! Set up your farm to get started.</span><small>Just now</small></div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <h2 class="section-title" data-i18n="dash.quickActions">Quick Actions</h2>
                <div class="feature-cards">
                    <div class="feature-card fc-green" onclick="navigate('farm-setup')">
                        <div class="fc-icon"><i class="fas fa-tractor"></i></div>
                        <div class="fc-text">
                            <h3 data-i18n="dash.setupFarm">Set Up Farm</h3>
                            <p data-i18n="dash.setupFarmDesc">Enter farm details for personalized AI advice</p>
                        </div>
                        <i class="fas fa-arrow-right fc-arrow"></i>
                    </div>
                    <div class="feature-card fc-green" onclick="navigate('recommendation')">
                        <div class="fc-icon"><i class="fas fa-seedling"></i></div>
                        <div class="fc-text">
                            <h3 data-i18n="dash.aiRec">AI Recommendations</h3>
                            <p data-i18n="dash.aiRecDesc">Get smart crop suggestions based on your farm</p>
                        </div>
                        <i class="fas fa-arrow-right fc-arrow"></i>
                    </div>
                    <div class="feature-card fc-blue" onclick="navigate('rotation')">
                        <div class="fc-icon"><i class="fas fa-calendar-alt"></i></div>
                        <div class="fc-text">
                            <h3 data-i18n="dash.cropRotation">Crop Rotation Planner</h3>
                            <p data-i18n="dash.cropRotationDesc">Plan seasonal rotations for better yields</p>
                        </div>
                        <i class="fas fa-arrow-right fc-arrow"></i>
                    </div>
                    <div class="feature-card fc-amber" onclick="navigate('fertilizer')">
                        <div class="fc-icon"><i class="fas fa-flask"></i></div>
                        <div class="fc-text">
                            <h3 data-i18n="dash.fertCalc">Fertilizer Calculator</h3>
                            <p data-i18n="dash.fertCalcDesc">Calculate optimal NPK requirements</p>
                        </div>
                        <i class="fas fa-arrow-right fc-arrow"></i>
                    </div>
                    <div class="feature-card fc-earth" onclick="navigate('farm-map')">
                        <div class="fc-icon"><i class="fas fa-map"></i></div>
                        <div class="fc-text">
                            <h3 data-i18n="dash.farmMap">Farm Map</h3>
                            <p data-i18n="dash.farmMapDesc">Interactive map with soil zones & risks</p>
                        </div>
                        <i class="fas fa-arrow-right fc-arrow"></i>
                    </div>
                </div>

                <!-- Explore More -->
                <h2 class="section-title" data-i18n="dash.exploreMore">Explore More</h2>
                <div class="explore-grid">
                    <div class="explore-card" onclick="navigate('market')"><i class="fas fa-chart-line text-green"></i><span data-i18n="dash.marketForecast">Market Forecast</span></div>
                    <div class="explore-card" onclick="navigate('community')"><i class="fas fa-users text-blue"></i><span data-i18n="dash.communityLabel">Community</span></div>
                    <div class="explore-card" onclick="navigate('weather')"><i class="fas fa-cloud-sun text-cyan"></i><span data-i18n="dash.weatherLabel">Weather</span></div>
                    <div class="explore-card" onclick="navigate('chatbot')"><i class="fas fa-robot text-purple"></i><span data-i18n="dash.aiChat">AI Chat</span></div>
                    <div class="explore-card" onclick="navigate('sustainability')"><i class="fas fa-leaf text-green"></i><span data-i18n="dash.sustainLabel">Sustainability</span></div>
                    <div class="explore-card" onclick="navigate('pest-prediction')"><i class="fas fa-bug text-red"></i><span data-i18n="dash.pestAlert">Pest Alert</span></div>
                </div>

                <!-- Usage Guide -->
                <div class="usage-guide">
                    <h2 class="section-title" data-i18n-html="dash.howToUse">ğŸ“‹ How to Use This App</h2>
                    <div class="steps-row">
                        <div class="step-card"><div class="step-num">1</div><h4 data-i18n="dash.step1Title">Detect Location</h4><p data-i18n="dash.step1Desc">Tap "Detect My Location" in Farm Setup â€” we get weather automatically</p></div>
                        <div class="step-card"><div class="step-num">2</div><h4 data-i18n="dash.step2Title">Get AI Recommendations</h4><p data-i18n="dash.step2Desc">4 AI agents analyze your data for the best crops</p></div>
                        <div class="step-card"><div class="step-num">3</div><h4 data-i18n="dash.step3Title">Plan Your Season</h4><p data-i18n="dash.step3Desc">Use rotation planner, fertilizer calc & market insights</p></div>
                        <div class="step-card"><div class="step-num">4</div><h4 data-i18n="dash.step4Title">Track & Improve</h4><p data-i18n="dash.step4Desc">Log sustainability data and learn from community</p></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== FARM SETUP ===== -->
        <section id="farm-setup-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-tractor"></i></div>
                    <div><h1 data-i18n="setup.title">Farm Setup</h1><p class="page-desc" data-i18n="setup.desc">Enter your farm details for personalized recommendations</p></div>
                </div>

                <!-- Guide -->
                <div class="feature-guide" id="setup-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#16a34a,#22d3ee)">
                        <i class="fas fa-tractor" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-info-circle"></i></div>
                        <div class="guide-text">
                            <strong>Easy 3 steps:</strong> 1ï¸âƒ£ Tap "Detect My Location" â€” we get your weather automatically. 2ï¸âƒ£ Enter your farm size & crop. 3ï¸âƒ£ Tell us how much fertilizer you use. That's it!
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>

                <!-- Location â€” Auto GPS -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-map-marker-alt"></i> <span data-i18n="setup.locationSettings">Your Location</span></h3>
                    <p class="card-desc" style="margin-bottom:1rem">We detect your location automatically to fetch weather & climate data.</p>
                    <div id="gps-status" class="gps-status-box">
                        <i class="fas fa-satellite-dish"></i> <span id="gps-status-text">Tap the button below to detect your location</span>
                    </div>
                    <button class="btn btn-primary btn-large" id="gps-detect-btn" onclick="detectMyLocation()" style="margin-top:0.75rem;width:100%">
                        <i class="fas fa-crosshairs"></i> Detect My Location
                    </button>
                    <div id="gps-result" style="display:none;margin-top:1rem">
                        <div class="gps-result-grid">
                            <div class="gps-chip"><i class="fas fa-map-pin"></i> <span id="gps-place-name">â€”</span></div>
                            <div class="gps-chip"><i class="fas fa-thermometer-half"></i> <span id="gps-temp">â€”</span></div>
                            <div class="gps-chip"><i class="fas fa-tint"></i> <span id="gps-hum">â€”</span></div>
                            <div class="gps-chip"><i class="fas fa-cloud-rain"></i> <span id="gps-rain">â€”</span></div>
                        </div>
                    </div>
                    <!-- Hidden inputs for lat/lon -->
                    <input type="hidden" id="user-lat" value="12.9716">
                    <input type="hidden" id="user-lon" value="77.5946">
                    <input type="hidden" id="city-name" value="">
                </div>

                <!-- Farm Details -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-seedling"></i> <span data-i18n="setup.farmDetails">Farm Details</span></h3>
                    <div class="input-grid-3 advanced-only">
                        <div class="form-group">
                            <label>Farm Size</label>
                            <div class="input-with-unit">
                                <input type="number" id="land-size" value="8" min="0.1" max="500" step="0.1">
                                <select id="land-unit" onchange="convertLandUnit()">
                                    <option value="hectares">Hectares</option>
                                    <option value="cents">Cents</option>
                                    <option value="acres">Acres</option>
                                </select>
                            </div>
                            <small id="land-converted"></small>
                        </div>
                        <div class="form-group">
                            <label>Crop Preference</label>
                            <select id="crop-preference">
                                <option value="Grains">ğŸŒ¾ Grains (Wheat, Rice, Corn)</option>
                                <option value="Vegetables">ğŸ¥¬ Vegetables</option>
                                <option value="Fruits">ğŸ Fruits</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Soil Type</label>
                            <select id="soil-type">
                                <option value="Loamy">Loamy (Best for most crops)</option>
                                <option value="Sandy">Sandy</option>
                                <option value="Clay">Clay</option>
                                <option value="Black">Black / Cotton soil</option>
                                <option value="Red">Red soil</option>
                                <option value="Silty">Silty</option>
                            </select>
                        </div>
                    </div>

                    <!-- â•â•â• VISUAL CROP PICKER (Simple Mode) â•â•â• -->
                    <div class="visual-crop-picker simple-only" id="visual-crop-picker" style="display:none">
                        <h4 class="visual-picker-title" data-i18n="simple.whatToGrow">ğŸŒ± What do you want to grow?</h4>
                        <p class="visual-picker-hint" data-i18n="simple.tapCrop">Tap a picture to choose:</p>
                        <div class="visual-picker-grid">
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Rice', this)">
                                <span class="vc-emoji">ğŸŒ¾</span>
                                <span class="vc-name" data-i18n="crop.rice">Rice</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Wheat', this)">
                                <span class="vc-emoji">ğŸŒ¾</span>
                                <span class="vc-name" data-i18n="crop.wheat">Wheat</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Corn', this)">
                                <span class="vc-emoji">ğŸŒ½</span>
                                <span class="vc-name" data-i18n="crop.corn">Corn</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Tomato', this)">
                                <span class="vc-emoji">ğŸ…</span>
                                <span class="vc-name" data-i18n="crop.tomato">Tomato</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Potato', this)">
                                <span class="vc-emoji">ğŸ¥”</span>
                                <span class="vc-name" data-i18n="crop.potato">Potato</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Cotton', this)">
                                <span class="vc-emoji">ğŸµï¸</span>
                                <span class="vc-name" data-i18n="crop.cotton">Cotton</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Soybean', this)">
                                <span class="vc-emoji">ğŸ«˜</span>
                                <span class="vc-name" data-i18n="crop.soybean">Soybean</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Vegetables', this)">
                                <span class="vc-emoji">ğŸ¥¬</span>
                                <span class="vc-name" data-i18n="crop.vegetables">Vegetables</span>
                            </button>
                            <button class="visual-crop-btn" onclick="selectVisualCrop('Fruits', this)">
                                <span class="vc-emoji">ğŸ</span>
                                <span class="vc-name" data-i18n="crop.fruits">Fruits</span>
                            </button>
                        </div>
                    </div>

                    <!-- â•â•â• VISUAL SOIL PICKER (Simple Mode) â•â•â• -->
                    <div class="visual-soil-picker simple-only" id="visual-soil-picker" style="display:none">
                        <h4 class="visual-picker-title" data-i18n="simple.soilType">ğŸª¨ What does your soil look like?</h4>
                        <p class="visual-picker-hint" data-i18n="simple.tapSoil">Tap the closest match:</p>
                        <div class="visual-soil-grid">
                            <button class="visual-soil-btn" onclick="selectVisualSoil('Loamy', this)">
                                <div class="vs-swatch" style="background:linear-gradient(135deg,#8B7355,#A0926B)"></div>
                                <span class="vs-name" data-i18n="soil.loamy">Loamy</span>
                                <span class="vs-desc">ğŸ‘</span>
                            </button>
                            <button class="visual-soil-btn" onclick="selectVisualSoil('Sandy', this)">
                                <div class="vs-swatch" style="background:linear-gradient(135deg,#C2B280,#D4C99E)"></div>
                                <span class="vs-name" data-i18n="soil.sandy">Sandy</span>
                                <span class="vs-desc">ğŸ–ï¸</span>
                            </button>
                            <button class="visual-soil-btn" onclick="selectVisualSoil('Clay', this)">
                                <div class="vs-swatch" style="background:linear-gradient(135deg,#8B4513,#A0522D)"></div>
                                <span class="vs-name" data-i18n="soil.clay">Clay</span>
                                <span class="vs-desc">ğŸ’§</span>
                            </button>
                            <button class="visual-soil-btn" onclick="selectVisualSoil('Black', this)">
                                <div class="vs-swatch" style="background:linear-gradient(135deg,#3B3131,#4A4040)"></div>
                                <span class="vs-name" data-i18n="soil.black">Black</span>
                                <span class="vs-desc">ğŸ–¤</span>
                            </button>
                            <button class="visual-soil-btn" onclick="selectVisualSoil('Red', this)">
                                <div class="vs-swatch" style="background:linear-gradient(135deg,#A0522D,#CD6839)"></div>
                                <span class="vs-name" data-i18n="soil.red">Red</span>
                                <span class="vs-desc">â¤ï¸</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- NPK â€” Farmer-Friendly -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-flask"></i> <span>Fertilizer You Use</span></h3>
                    <p class="card-desc" style="margin-bottom:0.75rem">Tell us how much fertilizer you put on your field. Pick the closest option:</p>
                    <div class="npk-simple-grid">
                        <div class="npk-item">
                            <label class="npk-label">ğŸŒ¿ <strong>Urea / Nitrogen</strong></label>
                            <p class="npk-hint">Makes leaves green & crops grow tall</p>
                            <div class="npk-emoji-row" id="npk-n-row">
                                <button class="npk-btn selected" onclick="setNPK('n',0,this)" data-val="0">âŒ None</button>
                                <button class="npk-btn" onclick="setNPK('n',25,this)" data-val="25">ğŸ¤ Little</button>
                                <button class="npk-btn" onclick="setNPK('n',50,this)" data-val="50">ğŸ‘ Medium</button>
                                <button class="npk-btn" onclick="setNPK('n',90,this)" data-val="90">ğŸ’ª A Lot</button>
                            </div>
                        </div>
                        <div class="npk-item">
                            <label class="npk-label">ğŸŒ¸ <strong>DAP / Phosphorus</strong></label>
                            <p class="npk-hint">Helps flowers, fruits & strong roots</p>
                            <div class="npk-emoji-row" id="npk-p-row">
                                <button class="npk-btn selected" onclick="setNPK('p',0,this)" data-val="0">âŒ None</button>
                                <button class="npk-btn" onclick="setNPK('p',20,this)" data-val="20">ğŸ¤ Little</button>
                                <button class="npk-btn" onclick="setNPK('p',45,this)" data-val="45">ğŸ‘ Medium</button>
                                <button class="npk-btn" onclick="setNPK('p',80,this)" data-val="80">ğŸ’ª A Lot</button>
                            </div>
                        </div>
                        <div class="npk-item">
                            <label class="npk-label">ğŸ¥” <strong>Potash / Potassium</strong></label>
                            <p class="npk-hint">Makes crops strong & disease resistant</p>
                            <div class="npk-emoji-row" id="npk-k-row">
                                <button class="npk-btn selected" onclick="setNPK('k',0,this)" data-val="0">âŒ None</button>
                                <button class="npk-btn" onclick="setNPK('k',20,this)" data-val="20">ğŸ¤ Little</button>
                                <button class="npk-btn" onclick="setNPK('k',40,this)" data-val="40">ğŸ‘ Medium</button>
                                <button class="npk-btn" onclick="setNPK('k',80,this)" data-val="80">ğŸ’ª A Lot</button>
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="nitrogen" value="0">
                    <input type="hidden" id="phosphorus" value="0">
                    <input type="hidden" id="potassium" value="0">
                </div>

                <!-- Auto-fetched Weather (read-only display) -->
                <div class="card" id="auto-weather-card" style="display:none">
                    <h3 class="card-title"><i class="fas fa-cloud-sun"></i> <span>Weather & Soil (Auto-detected)</span></h3>
                    <p class="card-desc">These values were fetched automatically from your location. You can adjust if needed.</p>
                    <div class="auto-param-grid">
                        <div class="auto-param"><i class="fas fa-thermometer-half"></i><span class="auto-param-label">Temperature</span><span class="auto-param-val" id="auto-temp-val">25Â°C</span></div>
                        <div class="auto-param"><i class="fas fa-tint"></i><span class="auto-param-label">Humidity</span><span class="auto-param-val" id="auto-hum-val">60%</span></div>
                        <div class="auto-param"><i class="fas fa-cloud-rain"></i><span class="auto-param-label">Rainfall</span><span class="auto-param-val" id="auto-rain-val">500 mm</span></div>
                        <div class="auto-param"><i class="fas fa-vial"></i><span class="auto-param-label">Soil pH</span><span class="auto-param-val" id="auto-ph-val">6.5</span></div>
                    </div>
                    <input type="hidden" id="temperature" value="25">
                    <input type="hidden" id="humidity" value="60">
                    <input type="hidden" id="rainfall" value="500">
                    <input type="hidden" id="ph" value="6.5">
                </div>

                <button class="btn btn-primary btn-large" onclick="saveFarmSetup()"><i class="fas fa-save"></i> <span data-i18n="setup.saveFarm">Save Farm Details</span></button>
            </div>
        </section>

        <!-- ===== AI RECOMMENDATIONS ===== -->
        <section id="recommendation-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-seedling"></i></div>
                    <div><h1 data-i18n="rec.title">AI Recommendations</h1><p class="page-desc" data-i18n="rec.desc">Smart crop suggestions based on your farm data</p></div>
                    <button class="btn btn-outline btn-sm ml-auto" onclick="getRecommendation()"><i class="fas fa-sync-alt"></i> <span data-i18n="rec.regenerate">Regenerate</span></button>
                </div>
                <div class="feature-guide" id="rec-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#8b5cf6,#ec4899)">
                        <i class="fas fa-brain" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-lightbulb"></i></div>
                        <div class="guide-text">
                            <strong>How it works:</strong> Our AI agents analyze your soil, weather, market prices & sustainability to recommend the best crops. Tap "Generate Now" and watch the agents discuss!
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>
                <div id="recommendation-results">
                    <div class="empty-state">
                        <i class="fas fa-seedling"></i>
                        <h3 data-i18n="rec.noRec">No Recommendations Yet</h3>
                        <p data-i18n="rec.noRecDesc">Set up your farm details first, then generate AI recommendations.</p>
                        <button class="btn btn-primary" onclick="getRecommendation()"><i class="fas fa-brain"></i> <span data-i18n="rec.generateNow">Generate Now</span></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== CROP ROTATION PLANNER ===== -->
        <section id="rotation-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-blue"><i class="fas fa-calendar-alt"></i></div>
                    <div><h1 data-i18n="rot.title">Crop Rotation Planner</h1><p class="page-desc" data-i18n="rot.desc">Plan sustainable rotations for better yields and soil health</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-seedling"></i> <span data-i18n="rot.currentCrop">Current Crop</span></h3>
                    <div class="form-group"><select id="current-crop"><option>Wheat</option><option>Corn</option><option>Rice</option><option>Soybean</option><option>Tomato</option><option>Cotton</option><option>Potato</option></select></div>
                    <button class="btn btn-primary" onclick="generateRotationPlan()"><i class="fas fa-calendar-alt"></i> <span data-i18n="rot.generatePlan">Generate Rotation Plan</span></button>
                </div>
                <div id="rotation-results" class="results-area"></div>
                <div class="card mt-4"><h3 class="card-title"><i class="fas fa-calendar"></i> <span data-i18n="rot.timeline">Rotation Timeline</span></h3><div id="rotation-timeline-chart" class="chart-container"></div></div>
            </div>
        </section>

        <!-- ===== FERTILIZER CALCULATOR ===== -->
        <section id="fertilizer-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-amber"><i class="fas fa-flask"></i></div>
                    <div><h1 data-i18n="fert.title">Fertilizer Calculator</h1><p class="page-desc" data-i18n="fert.desc">Calculate exact NPK requirements for your farm</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-edit"></i> <span data-i18n="fert.farmDetails">Farm Details</span></h3>
                    <div class="input-grid-3">
                        <div class="form-group"><label>Soil Type</label><select id="fert-soil"><option>Loamy</option><option>Sandy</option><option>Clay</option></select></div>
                        <div class="form-group"><label>Crop</label><select id="fert-crop"><option>Wheat</option><option>Corn</option><option>Rice</option><option>Tomatoes</option><option>Soybeans</option><option>Carrots</option></select></div>
                        <div class="form-group"><label>Land Size (ha)</label><input type="number" id="fert-land" value="8" min="0.1" max="500"></div>
                    </div>
                    <button class="btn btn-primary" onclick="calculateFertilizer()"><i class="fas fa-calculator"></i> <span data-i18n="fert.calculate">Calculate</span></button>
                </div>
                <div id="fertilizer-results" class="results-area"></div>
                <div class="card mt-4"><h3 class="card-title"><i class="fas fa-chart-bar"></i> <span data-i18n="fert.nutrientBreakdown">Nutrient Breakdown</span></h3><div id="fertilizer-chart" class="chart-container"></div></div>
            </div>
        </section>

        <!-- ===== FARM MAP ===== -->
        <section id="farm-map-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-earth"><i class="fas fa-map"></i></div>
                    <div><h1 data-i18n="map.title">Interactive Farm Map</h1><p class="page-desc" data-i18n="map.desc">Visualize soil zones, risk areas, and get location-specific advice</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-cog"></i> <span data-i18n="map.settings">Map Settings</span></h3>
                    <div class="input-row-2">
                        <div class="form-group"><label>Latitude</label><input type="number" id="farm-lat" value="12.9716" step="0.0001"></div>
                        <div class="form-group"><label>Longitude</label><input type="number" id="farm-lon" value="77.5946" step="0.0001"></div>
                    </div>
                    <div class="btn-row">
                        <button class="btn btn-primary" onclick="createFarmMap()"><i class="fas fa-map"></i> <span data-i18n="map.create">Create Map</span></button>
                        <button class="btn btn-outline" onclick="loadSavedMap()"><i class="fas fa-folder-open"></i> <span data-i18n="map.loadSaved">Load Saved</span></button>
                        <button class="btn btn-outline" onclick="saveFarmMap()"><i class="fas fa-save"></i> <span data-i18n="map.saveMap">Save Map</span></button>
                    </div>
                </div>
                <div class="card mt-4">
                    <div id="farm-map-container" style="height:420px;border-radius:12px;overflow:hidden;background:#f0fdf4"></div>
                    <div class="map-legend">
                        <h4 data-i18n="map.legend">Legend</h4>
                        <div class="legend-items">
                            <div class="legend-item"><span class="legend-dot" style="background:#8B4513"></span> <span data-i18n="map.claySoil">Clay Soil</span></div>
                            <div class="legend-item"><span class="legend-dot" style="background:#C2B280"></span> <span data-i18n="map.sandySoil">Sandy Soil</span></div>
                            <div class="legend-item"><span class="legend-dot" style="background:#228B22"></span> <span data-i18n="map.loamySoil">Loamy Soil</span></div>
                            <div class="legend-item"><span class="legend-dot" style="background:#dc2626"></span> <span data-i18n="map.erosionRisk">Erosion Risk</span></div>
                            <div class="legend-item"><span class="legend-dot" style="background:#2563eb"></span> <span data-i18n="map.waterlogging">Waterlogging</span></div>
                        </div>
                    </div>
                </div>
                <div class="card mt-4" id="map-recs-card" style="display:none">
                    <h3 class="card-title"><i class="fas fa-clipboard-list"></i> <span data-i18n="map.locationRecs">Location-Specific Recommendations</span></h3>
                    <div id="map-rec-content"></div>
                </div>
            </div>
        </section>

        <!-- ===== SUSTAINABILITY ===== -->
        <section id="sustainability-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-chart-bar"></i></div>
                    <div><h1 data-i18n="sust.title">Sustainability Tracker</h1><p class="page-desc" data-i18n="sust.desc">Monitor and improve your environmental impact</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-clipboard-list"></i> <span data-i18n="sust.logPractices">Log Season Practices</span></h3>
                    <div class="input-grid-3">
                        <div class="form-group"><label>Water Usage (ML/ha)</label><input type="number" id="water-usage" value="2.0" step="0.1" min="0" max="10"><small>Recommended: â‰¤ 2.0 ML/ha</small></div>
                        <div class="form-group"><label>Fertilizer (tons/ha)</label><input type="number" id="fertilizer-use" value="1.5" step="0.1" min="0" max="10"><small>Recommended: â‰¤ 1.5 tons/ha</small></div>
                        <div class="form-group"><label>Crop Rotation?</label><select id="crop-rotation"><option value="yes">Yes, rotation practiced</option><option value="no">No rotation this season</option></select></div>
                    </div>
                    <button class="btn btn-primary" onclick="logSustainability()"><i class="fas fa-save"></i> <span data-i18n="sust.logData">Log Data</span></button>
                </div>
                <div class="two-col mt-4">
                    <div class="card"><h3 class="card-title"><i class="fas fa-chart-area"></i> Score Over Time</h3><div id="sustainability-trend-chart" class="chart-container"></div></div>
                    <div class="card" id="sustainability-tips"><h3 class="card-title"><i class="fas fa-lightbulb"></i> Improvement Tips</h3><p class="muted-text">Log your data to get personalized sustainability tips.</p></div>
                </div>
            </div>
        </section>

        <!-- ===== COMMUNITY ===== -->
        <section id="community-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-blue"><i class="fas fa-users"></i></div>
                    <div><h1 data-i18n="comm.title">Community Insights</h1><p class="page-desc" data-i18n="comm.desc">Share data anonymously and learn from other farmers</p></div>
                </div>
                <div class="feature-guide" id="community-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#0ea5e9,#6366f1)">
                        <i class="fas fa-users" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-hands-helping"></i></div>
                        <div class="guide-text">
                            <strong>Help & Learn:</strong> Share your crop yield & price data to help other farmers. See what works best in your region. All data stays anonymous!
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>
                <!-- Share -->
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-share-alt"></i> Share Your Data (Anonymous)</h3>
                    <p class="card-desc">Help fellow farmers by sharing your yield and price data.</p>
                    <div class="input-grid-3">
                        <div class="form-group"><label>Crop</label><select id="community-crop"><option>Rice</option><option>Wheat</option><option>Corn</option><option>Soybean</option><option>Tomato</option><option>Potato</option><option>Cotton</option></select></div>
                        <div class="form-group"><label>Yield (tons/ha)</label><input type="number" id="community-yield" value="3.0" step="0.1" min="0"></div>
                        <div class="form-group"><label>Market Price (â‚¹/ton)</label><input type="number" id="community-price" value="20000" step="100" min="0"></div>
                        <div class="form-group"><label>Region</label><select id="community-region"><option>North</option><option>South</option><option>East</option><option>West</option><option>Central</option></select></div>
                        <div class="form-group"><label>Season</label><select id="community-season"><option>Kharif (Monsoon)</option><option>Rabi (Winter)</option><option>Zaid (Summer)</option><option>Year-round</option></select></div>
                        <div class="form-group"><label>Practice</label><select id="community-practice"><option>Organic Farming</option><option>Drip Irrigation</option><option>Crop Rotation</option><option>Integrated Pest Mgmt</option><option>Conservation Tillage</option></select></div>
                    </div>
                    <button class="btn btn-primary" onclick="shareCommunityData()"><i class="fas fa-paper-plane"></i> <span data-i18n="comm.shareBtn">Share Data</span></button>
                </div>
                <!-- My Posts -->
                <div class="card mt-4">
                    <h3 class="card-title"><i class="fas fa-user-circle"></i> My Shared Posts</h3>
                    <div id="my-community-posts"><p class="muted-text">Your shared data will appear here.</p></div>
                </div>
                <!-- Dashboard -->
                <div class="card mt-4">
                    <h3 class="card-title"><i class="fas fa-chart-bar"></i> Regional Insights</h3>
                    <div class="stat-grid cols-2">
                        <div class="stat-card stat-green"><div class="stat-value">3.9</div><div class="stat-label">Avg Yield (t/ha)</div></div>
                        <div class="stat-card stat-blue"><div class="stat-value">â‚¹2,500</div><div class="stat-label">Avg Price (per quintal)</div></div>
                    </div>
                    <div id="community-chart" class="chart-container mt-3"></div>
                </div>
                <!-- Best Practices -->
                <div class="card mt-4">
                    <h3 class="card-title"><i class="fas fa-award"></i> Top Practices from Farmers</h3>
                    <div class="practice-list" id="practice-list">
                        <div class="practice-item"><span class="practice-pct">78%</span><span>Neem-based pest control <small>South India</small></span></div>
                        <div class="practice-item"><span class="practice-pct">65%</span><span>Mulching to retain moisture <small>West India</small></span></div>
                        <div class="practice-item"><span class="practice-pct">52%</span><span>Vermicomposting <small>North India</small></span></div>
                        <div class="practice-item"><span class="practice-pct">48%</span><span>Intercropping with legumes <small>Central India</small></span></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== MARKET FORECAST ===== -->
        <section id="market-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-chart-line"></i></div>
                    <div><h1 data-i18n="mkt.title">Market Forecast</h1><p class="page-desc" data-i18n="mkt.desc">AI-powered price predictions and market insights</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-cog"></i> <span data-i18n="mkt.forecastSettings">Forecast Settings</span></h3>
                    <div class="input-row-2">
                        <div class="form-group"><label>Crop</label><select id="market-crop"><option>Rice</option><option>Wheat</option><option>Corn</option><option>Soybean</option><option>Tomato</option><option>Cotton</option><option>Potato</option></select></div>
                        <div class="form-group"><label>Period</label><select id="forecast-period"><option value="3">3 Months</option><option value="6">6 Months</option><option value="12">12 Months</option></select></div>
                    </div>
                    <button class="btn btn-primary" onclick="generateMarketForecast()"><i class="fas fa-chart-line"></i> <span data-i18n="mkt.generate">Generate Forecast</span></button>
                </div>
                <div class="two-col mt-4">
                    <div class="card"><h3 class="card-title"><i class="fas fa-rupee-sign"></i> Price Forecast</h3><div id="market-price-chart" class="chart-container"></div></div>
                    <div class="card" id="market-insights"><h3 class="card-title"><i class="fas fa-lightbulb"></i> Market Insights</h3><p class="muted-text">Generate a forecast to see insights and recommendations.</p></div>
                </div>
            </div>
        </section>

        <!-- ===== AI CHATBOT ===== -->
        <section id="chatbot-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-purple"><i class="fas fa-comment-dots"></i></div>
                    <div><h1 data-i18n="chat.title">AI Farming Assistant</h1><p class="page-desc" data-i18n="chat.desc">Ask any farming question and get instant answers</p></div>
                </div>
                <div class="chat-container card">
                    <div id="chat-messages" class="chat-messages">
                        <div class="chat-msg ai"><div class="chat-avatar"><i class="fas fa-robot"></i></div><div class="chat-bubble" data-i18n="chat.welcome">Hello! I'm your AI farming assistant ğŸŒ¾. Ask me about crops, soil, weather, pests, fertilizers, or any farming topic!</div></div>
                    </div>
                    <div class="chat-input-bar">
                        <input type="text" id="chat-input" placeholder="Ask a farming question..." data-i18n-placeholder="chat.placeholder" onkeypress="if(event.key==='Enter')sendChatMessage()">
                        <button class="btn btn-primary btn-icon-only" onclick="sendChatMessage()"><i class="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== WEATHER ===== -->
        <section id="weather-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-cyan"><i class="fas fa-cloud-sun"></i></div>
                    <div><h1 data-i18n="weather.title">Weather Intelligence</h1><p class="page-desc" data-i18n="weather.desc">Real-time weather with agricultural risk assessments</p></div>
                </div>
                <div class="feature-guide" id="weather-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#38bdf8,#06b6d4)">
                        <i class="fas fa-cloud-sun" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-cloud-sun-rain"></i></div>
                        <div class="guide-text">
                            <strong>Plan with weather:</strong> Get real-time weather forecasts and risk alerts for your location. Know the best time to plant, irrigate, or harvest.
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-map-marker-alt"></i> Location</h3>
                    <div class="input-grid-3">
                        <div class="form-group"><label>Latitude</label><input type="number" id="weather-lat" value="12.9716" step="0.0001"></div>
                        <div class="form-group"><label>Longitude</label><input type="number" id="weather-lon" value="77.5946" step="0.0001"></div>
                        <div class="form-group"><label>Crop Type</label><select id="weather-crop"><option>Grains</option><option>Vegetables</option><option>Fruits</option></select></div>
                    </div>
                    <button class="btn btn-primary" onclick="getWeatherForecast()"><i class="fas fa-cloud-sun"></i> <span data-i18n="weather.getForecast">Get Forecast</span></button>
                </div>
                <div id="weather-results" class="results-area mt-4"></div>
                <div class="card mt-4"><h3 class="card-title"><i class="fas fa-chart-area"></i> 7-Day Forecast</h3><div id="weather-forecast-chart" class="chart-container"></div></div>
            </div>
        </section>

        <!-- ===== SOIL ANALYSIS ===== -->
        <section id="soil-analysis-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-earth"><i class="fas fa-microscope"></i></div>
                    <div><h1 data-i18n="soil.title">Soil Analysis</h1><p class="page-desc" data-i18n="soil.desc">Upload a photo for AI analysis or select manually</p></div>
                </div>
                <div class="feature-guide" id="soil-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#92400e,#d97706)">
                        <i class="fas fa-microscope" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-info-circle"></i></div>
                        <div class="guide-text">
                            <strong>How it works:</strong> Take a clear photo of your soil and upload it. Our AI will identify the soil type. Or simply pick your soil type manually below!
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>
                <div class="two-col">
                    <div class="card">
                        <h3 class="card-title" data-i18n="soil.uploadTitle">ğŸ“¸ Upload Soil Photo</h3>
                        <div class="upload-zone" id="soil-upload-area" onclick="document.getElementById('soil-photo').click()">
                            <i class="fas fa-camera"></i>
                            <p data-i18n="soil.uploadDesc">Click or drag a soil photo here</p>
                            <small data-i18n="soil.uploadHint">JPG, PNG â€” Clear close-up works best</small>
                        </div>
                        <input type="file" id="soil-photo" accept="image/*" style="display:none" onchange="previewSoilPhoto(this)">
                        <div id="soil-preview" style="display:none;margin-top:1rem;text-align:center"></div>
                        <button class="btn btn-primary mt-3" onclick="analyzeSoil()"><i class="fas fa-search"></i> <span data-i18n="soil.analyze">Analyze Soil</span></button>
                    </div>
                    <div class="card">
                        <h3 class="card-title" data-i18n="soil.manualTitle">ğŸ“ Manual Selection</h3>
                        <div class="soil-options">
                            <div class="soil-opt" onclick="selectSoilType('Loamy')"><div class="soil-swatch" style="background:#8B7355"></div><h4>Loamy</h4><p>Best for most crops. Good drainage.</p></div>
                            <div class="soil-opt" onclick="selectSoilType('Sandy')"><div class="soil-swatch" style="background:#C2B280"></div><h4>Sandy</h4><p>Drains fast. Good for root crops.</p></div>
                            <div class="soil-opt" onclick="selectSoilType('Clay')"><div class="soil-swatch" style="background:#8B4513"></div><h4>Clay</h4><p>Holds water. Good for rice, wheat.</p></div>
                            <div class="soil-opt" onclick="selectSoilType('Black')"><div class="soil-swatch" style="background:#3B3131"></div><h4>Black</h4><p>Rich in minerals. Best for cotton.</p></div>
                            <div class="soil-opt" onclick="selectSoilType('Red')"><div class="soil-swatch" style="background:#A0522D"></div><h4>Red</h4><p>Iron-rich. Good for pulses.</p></div>
                        </div>
                    </div>
                </div>
                <div id="soil-results" class="results-area mt-4"></div>
            </div>
        </section>

        <!-- ===== PEST PREDICTION ===== -->
        <section id="pest-prediction-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-red"><i class="fas fa-bug"></i></div>
                    <div><h1 data-i18n="pest.title">Pest & Disease Prediction</h1><p class="page-desc" data-i18n="pest.desc">Real-time AI early-warning system using your location weather</p></div>
                </div>
                <!-- Guide tooltip -->
                <div class="feature-guide" id="pest-guide">
                    <div class="guide-anim-icon" style="background:linear-gradient(135deg,#ef4444,#f97316)">
                        <i class="fas fa-shield-alt" style="font-size:1.8rem;color:white"></i>
                    </div>
                    <div class="guide-content">
                        <div class="guide-icon"><i class="fas fa-info-circle"></i></div>
                        <div class="guide-text">
                            <strong>How it works:</strong> We use real-time weather from your location + your crop to predict pest risks using AI. Just select your crop and tap Analyze!
                        </div>
                    </div>
                    <button class="guide-close" onclick="this.parentElement.style.display='none'"><i class="fas fa-times"></i></button>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-sliders-h"></i> Farm Conditions</h3>
                    <p class="card-desc">Weather data is auto-filled from your farm location. Just select your crop!</p>
                    <div class="input-grid-3">
                        <div class="form-group"><label>Crop</label><select id="pest-crop"><option>Wheat</option><option>Rice</option><option>Corn</option><option>Tomato</option><option>Cotton</option><option>Soybean</option><option>Potato</option></select></div>
                        <div class="form-group"><label>Soil Type</label><select id="pest-soil"><option>Loamy</option><option>Clay</option><option>Sandy</option><option>Silty</option><option>Black</option><option>Red</option></select></div>
                        <div class="form-group"><label>Temperature Â°C <small>(auto)</small></label><input type="number" id="pest-temp" value="25" readonly style="opacity:0.7"></div>
                        <div class="form-group"><label>Humidity % <small>(auto)</small></label><input type="number" id="pest-humidity" value="65" readonly style="opacity:0.7"></div>
                        <div class="form-group"><label>Rainfall mm <small>(auto)</small></label><input type="number" id="pest-rainfall" value="500" readonly style="opacity:0.7"></div>
                    </div>
                    <button class="btn btn-primary" onclick="predictPests()"><i class="fas fa-shield-alt"></i> <span data-i18n="pest.analyze">Analyze Pest Risk</span></button>
                </div>
                <div id="pest-results" class="results-area mt-4"></div>
            </div>
        </section>

        <!-- ===== HISTORY / PREVIOUS RECOMMENDATIONS ===== -->
        <section id="history-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-history"></i></div>
                    <div><h1 data-i18n="hist.title">My Recommendations</h1><p class="page-desc" data-i18n="hist.desc">View previous recommendations and farming history</p></div>
                    <button class="btn btn-outline btn-sm ml-auto" onclick="exportRecommendations()"><i class="fas fa-download"></i> <span data-i18n="hist.export">Export CSV</span></button>
                </div>
                <div class="card" id="history-table-container">
                    <p class="muted-text">No recommendations yet. Use AI Recommendations to get started!</p>
                </div>
                <div class="card mt-4"><h3 class="card-title"><i class="fas fa-chart-bar"></i> Analytics</h3><div id="history-analytics-chart" class="chart-container"></div></div>
            </div>
        </section>

        <!-- ===== OFFLINE MODE ===== -->
        <section id="offline-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-purple"><i class="fas fa-cloud"></i></div>
                    <div><h1 data-i18n="offline.title">Offline Mode</h1><p class="page-desc" data-i18n="offline.desc">Use the app without internet. Data syncs automatically.</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title"><i class="fas fa-signal"></i> Connection Status</h3>
                    <div class="status-box" id="offline-status-box">
                        <i class="fas fa-wifi text-green"></i>
                        <span>You are online â€” All features available</span>
                    </div>
                </div>
                <div class="card mt-4">
                    <h3 class="card-title"><i class="fas fa-database"></i> Offline Data</h3>
                    <p>When offline, recommendations use saved data. Unsynced entries upload when you reconnect.</p>
                    <div class="info-rows mt-3">
                        <div class="info-row"><span>Saved recommendations</span><strong id="offline-recs-count">0</strong></div>
                        <div class="info-row"><span>Pending sync</span><strong id="offline-pending-count">0</strong></div>
                    </div>
                    <button class="btn btn-primary mt-3" onclick="syncOfflineData()"><i class="fas fa-sync-alt"></i> <span data-i18n="offline.syncNow">Sync Now</span></button>
                </div>
            </div>
        </section>

        <!-- ===== PROFILE / SETTINGS (3 tabs) ===== -->
        <section id="profile-page" class="page">
            <div class="page-pad">
                <div class="page-title-row">
                    <div class="page-icon bg-green"><i class="fas fa-cog"></i></div>
                    <div><h1 data-i18n="profile.title">Profile & Settings</h1><p class="page-desc" data-i18n="profile.desc">Manage profile, view history, and configure app settings</p></div>
                </div>

                <div class="profile-tabs">
                    <button class="ptab active" onclick="switchProfileTab('info')"><i class="fas fa-user"></i> <span data-i18n="profile.profileTab">Profile</span></button>
                    <button class="ptab" onclick="switchProfileTab('farm-hist')"><i class="fas fa-chart-bar"></i> <span data-i18n="profile.farmHistTab">Farm History</span></button>
                    <button class="ptab" onclick="switchProfileTab('settings')"><i class="fas fa-cog"></i> <span data-i18n="profile.settingsTab">Settings</span></button>
                </div>

                <!-- Profile Info -->
                <div id="ptab-info" class="ptab-content active">
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-user"></i> <span data-i18n="profile.personalInfo">Personal Information</span></h3>
                        <div class="input-grid-2">
                            <div class="form-group"><label>Farmer Name</label><input type="text" id="farmer-name" value=""></div>
                            <div class="form-group"><label>Farm Name</label><input type="text" id="farm-name" value=""></div>
                            <div class="form-group"><label>Phone</label><input type="tel" id="profile-phone" value=""></div>
                            <div class="form-group"><label>Email (Optional)</label><input type="email" id="profile-email" value=""></div>
                            <div class="form-group"><label>Location</label><input type="text" id="profile-location" value=""></div>
                            <div class="form-group"><label>Experience Level</label><select id="experience-level"><option>Beginner</option><option>Intermediate</option><option>Advanced</option><option>Expert</option></select></div>
                            <div class="form-group"><label>Farm Size (hectares)</label><input type="number" id="profile-farm-size" value="5"></div>
                            <div class="form-group"><label>Region</label><select id="farm-region"><option>North</option><option>South</option><option>East</option><option>West</option><option>Central</option></select></div>
                        </div>
                        <button class="btn btn-primary" onclick="saveProfile()"><i class="fas fa-save"></i> <span data-i18n="profile.saveProfile">Save Profile</span></button>
                    </div>
                </div>

                <!-- Farming History -->
                <div id="ptab-farm-hist" class="ptab-content">
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-history"></i> Recent Recommendations</h3>
                        <div id="profile-recent-recs"><p class="muted-text">No recommendations yet.</p></div>
                    </div>
                    <div class="card mt-4"><h3 class="card-title"><i class="fas fa-chart-line"></i> Sustainability Score History</h3><div id="profile-sustainability-chart" class="chart-container"></div></div>
                </div>

                <!-- Settings -->
                <div id="ptab-settings" class="ptab-content">
                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-language"></i> <span data-i18n="profile.langVoice">Language & Voice</span></h3>
                        <div class="input-grid-2">
                            <div class="form-group"><label>Preferred Language</label><select id="settings-language" onchange="changeLanguage(this.value)"><option value="en">English</option><option value="hi">Hindi</option><option value="kn">Kannada</option><option value="te">Telugu</option><option value="ta">Tamil</option><option value="ml">Malayalam</option><option value="bn">Bengali</option><option value="gu">Gujarati</option><option value="mr">Marathi</option><option value="pa">Punjabi</option><option value="or">Odia</option></select></div>
                            <div class="form-group"><label>Voice Interface</label><select id="settings-voice"><option value="on">Enabled</option><option value="off">Disabled</option></select></div>
                        </div>
                    </div>
                    <div class="card mt-4">
                        <h3 class="card-title"><i class="fas fa-bell"></i> <span data-i18n="profile.notifications">Notifications</span></h3>
                        <div class="toggle-list">
                            <label class="toggle-row"><span>Weather Alerts</span><input type="checkbox" id="notify-weather" checked><span class="toggle-switch"></span></label>
                            <label class="toggle-row"><span>Pest Warnings</span><input type="checkbox" id="notify-pest"><span class="toggle-switch"></span></label>
                            <label class="toggle-row"><span>Market Price Updates</span><input type="checkbox" id="notify-market"><span class="toggle-switch"></span></label>
                        </div>
                    </div>
                    <div class="card mt-4">
                        <h3 class="card-title"><i class="fas fa-database"></i> <span data-i18n="profile.dataManagement">Data Management</span></h3>
                        <div class="btn-row">
                            <button class="btn btn-outline" onclick="exportProfileData()"><i class="fas fa-download"></i> Export Data (JSON)</button>
                            <button class="btn btn-outline" onclick="exportRecommendations()"><i class="fas fa-file-csv"></i> Export Recommendations (CSV)</button>
                        </div>
                    </div>
                    <div class="card mt-4">
                        <h3 class="card-title"><i class="fas fa-sign-out-alt"></i> <span data-i18n="profile.account">Account</span></h3>
                        <button class="btn btn-danger" onclick="logout()"><i class="fas fa-sign-out-alt"></i> <span data-i18n="nav.logout">Logout</span></button>
                    </div>
                </div>
            </div>
        </section>

    </div><!-- /main-area -->

    <!-- â”€â”€â”€â”€ MOBILE BOTTOM NAV â”€â”€â”€â”€ -->
    <nav class="mobile-bottom-nav" id="mobile-bottom-nav">
        <button class="mob-item" onclick="openMobileMenu()"><i class="fas fa-bars"></i><span data-i18n="mob.menu">Menu</span></button>
        <button class="mob-item active" data-page="dashboard" onclick="navigate('dashboard')"><i class="fas fa-home"></i><span data-i18n="mob.home">Home</span></button>
        <button class="mob-item" data-page="recommendation" onclick="navigate('recommendation')"><i class="fas fa-seedling"></i><span data-i18n="mob.ai">AI</span></button>
        <button class="mob-item" data-page="chatbot" onclick="navigate('chatbot')"><i class="fas fa-comment-dots"></i><span data-i18n="mob.chat">Chat</span></button>
        <button class="mob-item" data-page="profile" onclick="navigate('profile')"><i class="fas fa-user"></i><span data-i18n="mob.profile">Profile</span></button>
    </nav>

</div><!-- /app-shell -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOADING OVERLAY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="loading-overlay" id="loading-overlay" style="display:none">
    <div class="loading-box">
        <div class="loading-spinner"></div>
        <h3 data-i18n="loading.processing">Processing...</h3>
        <p id="loading-message" data-i18n="loading.aiAnalyzing">AI agents are analyzing your data</p>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• NOTIFICATION TOAST â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="toast-container" id="toast-container"></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EMERGENCY PEST HELP (Simple Mode) â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="emergency-pest-btn simple-only" id="emergency-pest-btn" style="display:none" onclick="emergencyPestHelp()">
    <div class="epb-pulse"></div>
    <span class="epb-icon">ğŸ†˜</span>
    <span class="epb-text" data-i18n="simple.cropDying">My Crop is Sick!</span>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• EMERGENCY PEST MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="emergency-modal" id="emergency-modal" style="display:none">
    <div class="emergency-modal-backdrop" onclick="closeEmergencyModal()"></div>
    <div class="emergency-modal-card">
        <h2><span style="font-size:2rem">ğŸ†˜</span> <span data-i18n="simple.emergencyTitle">Which crop needs help?</span></h2>
        <p data-i18n="simple.emergencyDesc">Tap your crop â€” we'll check for pest danger!</p>
        <div class="emergency-crop-grid">
            <button class="em-crop-btn" onclick="runEmergencyPest('Wheat')"><span>ğŸŒ¾</span>Wheat</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Rice')"><span>ğŸŒ¾</span>Rice</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Corn')"><span>ğŸŒ½</span>Corn</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Tomato')"><span>ğŸ…</span>Tomato</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Cotton')"><span>ğŸµï¸</span>Cotton</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Potato')"><span>ğŸ¥”</span>Potato</button>
            <button class="em-crop-btn" onclick="runEmergencyPest('Soybean')"><span>ğŸ«˜</span>Soybean</button>
        </div>
        <div class="emergency-result" id="emergency-result" style="display:none"></div>
        <button class="btn btn-outline" style="margin-top:1rem;width:100%" onclick="closeEmergencyModal()">âœ• Close</button>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• VOICE ASSISTANT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<button class="voice-fab" id="voice-btn" title="Voice Assistant" onclick="toggleVoicePanel()"><i class="fas fa-microphone" id="voice-btn-icon"></i></button>

<!-- Voice Assistant Panel -->
<div class="voice-panel" id="voice-panel" style="display:none">
    <div class="voice-panel-backdrop" onclick="closeVoicePanel()"></div>
    <div class="voice-panel-card">
        <!-- Header -->
        <div class="vp-header">
            <div class="vp-title"><i class="fas fa-robot"></i> <span data-i18n="voice.title">Voice Assistant</span></div>
            <button class="vp-close" onclick="closeVoicePanel()"><i class="fas fa-times"></i></button>
        </div>

        <!-- State Indicator -->
        <div class="vp-state" id="vp-state">
            <div class="vp-state-icon" id="vp-state-icon">
                <i class="fas fa-microphone"></i>
            </div>
            <div class="vp-state-text" id="vp-state-text">Tap the mic to speak</div>
            <!-- Sound wave animation -->
            <div class="vp-wave" id="vp-wave" style="display:none">
                <span></span><span></span><span></span><span></span><span></span>
            </div>
        </div>

        <!-- Big Mic Button -->
        <button class="vp-mic-btn" id="vp-mic-btn" onclick="toggleVoiceListening()">
            <i class="fas fa-microphone" id="vp-mic-icon"></i>
        </button>

        <!-- Transcript -->
        <div class="vp-transcript" id="vp-transcript" style="display:none">
            <div class="vp-transcript-label">You said:</div>
            <div class="vp-transcript-text" id="vp-transcript-text"></div>
        </div>

        <!-- Response -->
        <div class="vp-response" id="vp-response" style="display:none">
            <div class="vp-response-label"><i class="fas fa-robot"></i> AI Response:</div>
            <div class="vp-response-text" id="vp-response-text"></div>
            <button class="vp-replay-btn" onclick="replayVoiceResponse()"><i class="fas fa-volume-up"></i> Listen Again</button>
        </div>

        <!-- Quick Commands -->
        <div class="vp-commands">
            <div class="vp-commands-label">Try saying:</div>
            <div class="vp-chips">
                <button class="vp-chip" onclick="voiceQuickCommand('weather')">ğŸŒ¤ï¸ Weather</button>
                <button class="vp-chip" onclick="voiceQuickCommand('recommend crop')">ğŸŒ¾ Crop Advice</button>
                <button class="vp-chip" onclick="voiceQuickCommand('pest problem')">ğŸ› Pest Help</button>
                <button class="vp-chip" onclick="voiceQuickCommand('fertilizer')">ğŸ’Š Fertilizer</button>
                <button class="vp-chip" onclick="voiceQuickCommand('market price')">ğŸ“ˆ Prices</button>
                <button class="vp-chip" onclick="voiceQuickCommand('help')">â“ Help</button>
            </div>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• WALKTHROUGH OVERLAY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="walkthrough-overlay" id="walkthrough-overlay" style="display:none">
    <div class="walkthrough-backdrop" onclick="closeWalkthrough()"></div>
    <div class="walkthrough-card" id="walkthrough-card">
        <div class="walkthrough-progress">
            <div class="walkthrough-progress-bar" id="walkthrough-progress-bar"></div>
        </div>
        <div class="walkthrough-illustration" id="walkthrough-illustration">
            <!-- Animated SVG illustrations inserted by JS -->
        </div>
        <h2 class="walkthrough-title" id="walkthrough-title"></h2>
        <p class="walkthrough-desc" id="walkthrough-desc"></p>
        <div class="walkthrough-actions">
            <button class="btn btn-outline btn-sm" id="walkthrough-skip" onclick="closeWalkthrough()">Skip</button>
            <div class="walkthrough-dots" id="walkthrough-dots"></div>
            <button class="btn btn-primary btn-sm wt-next-btn" id="walkthrough-next" onclick="nextWalkthroughStep()">Next â†’</button>
        </div>
    </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CONFETTI CANVAS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<canvas id="confetti-canvas" style="position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:99999"></canvas>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• SCRIPTS â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script src="config.js"></script>
<script src="translations.js"></script>
<script src="app.js"></script>
<script src="voice-interface.js"></script>
<script src="offline-data.js"></script>

</body>
</html>
